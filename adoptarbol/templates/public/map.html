{% extends "layout_with_leaflet.html" %}

{% block content %}

<style>
    #mapid { height: 420px; }
</style>

<div class="body-content">
  <div class="well well-sm row">
    <h3 class="text-center">Adopta &nbsp; <span class="label label-large label-warning">PASO 1 </span> &nbsp; Selecciona a tu compañero ideal.</h3>
  </div><!-- /.well -->

  <br>
  <div class="well well-sm row">
        <div id="mapid"></div>
  </div><!-- /.well -->

<script>

window.onload = function () {


    var mymap = L.map('mapid').setView([-12.1717094, -69.3869664], 18);

    googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
        attribution: 'Árboles censados por Arbio - Imagen © Google',
        maxZoom: 20,
        subdomains:['mt0','mt1','mt2','mt3']
    }).addTo(mymap);

//    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
//                attribution: 'Imagery © <a href="http://mapbox.com">Mapbox</a>',
//                maxZoom: 22,
//               id: 'mapbox.satellite',
//                accessToken: 'pk.eyJ1IjoiaWNhcml0byIsImEiOiJjaW9zbTgxZ3MwMDk0dWZtNDFtNG84eGJzIn0.A-5TdlE4Ep-jXw_eIihJMA'
//            }).addTo(mymap);

    {% for tree in trees %}

    var popup = new L.Popup();

    var circle = L.circle([{{tree.coord_lat}}, {{tree.coord_lon}}], 5, {
        color: 'green',
        fillColor: 'yellow',
        fillOpacity: 0.5})
    .addTo(mymap)
    .bindPopup('Yo soy un {{tree.common_name}}.')
    .on('mouseover', function (e) {
            this.openPopup();
        })
    .on('mouseout', function (e) {
            this.closePopup();
        })
    .on('click',
        function(e) {
            location.href = '/adopt/{{tree.id}}';
        }
    );
    {% endfor %}

}

</script>

</div>
{% endblock %}
